<%# Navigation bar at the top   %>

<%# Map with the start locations of each gruppettos %>

<div class="" style="position: sticky; top: 6%; z-index:1000;">
  <div style="width:100%; height: 40vh;"
      data-controller="map"
      data-map-markers-value="<%= @markers.to_json %>"
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>
<div class=""  style=" width:100%;position:fixed; left: 50%; transform:translate(-50%, -50%);  z-index:1000; ">
<button type="button" class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#exampleModalScrollable">Search Filter</button>
  <ul class="nav nav-tabs nav-fill d-flex justify-content-around bd-highlight start-10" style="width:100%; background:white;" role="tablist">
    <li class="nav-item">
      <% if params[:type] == "upcoming" %>
        <%= link_to "Upcoming", gruppettos_path(type: "upcoming"), class: "nav-link active bg-primary bg-gradient text-white", data_toggle: "tab", role: "tab", aria_controls: "tasks", aria_selected: "true"%>
      <% else %>
        <%= link_to "Upcoming", gruppettos_path(type: "upcoming"), class: "nav-link bg-hover-primary-10", data_toggle: "tab", role: "tab", aria_controls: "files", aria_selected: "false"%>
      <% end %>
    </li>
    <li class="nav-item bg-hover-primary-10">
      <% if params[:type] == "going" %>
        <%= link_to "Going", gruppettos_path(type: "going"), class: "nav-link active bg-primary bg-gradient text-white", data_toggle: "tab", role: "tab", aria_controls: "tasks", aria_selected: "true"%>
      <% else %>
        <%= link_to "Going", gruppettos_path(type: "going"), class: "nav-link bg-hover-primary-10", data_toggle: "tab", role: "tab", aria_controls: "files", aria_selected: "false"%>
      <% end %>
    </li>
    <li class="nav-item bg-hover-primary-10">
      <% if params[:type] == "past" %>
        <%= link_to "Past", gruppettos_path(type: "past"), class: "nav-link active bg-primary bg-gradient text-white", data_toggle: "tab", role: "tab", aria_controls: "tasks", aria_selected: "true"%>
      <% else %>
        <%= link_to "Past", gruppettos_path(type: "past"), class: "nav-link bg-hover-primary-10", data_toggle: "tab", role: "tab", aria_controls: "files", aria_selected: "false"%>
      <% end %>
    </li>
  </ul>
</div>
<div class="container mt-4" style="position:relative; top:0;">
<div class="modal fade" id="exampleModalScrollable" tabindex="-1" aria-labelledby="exampleModalScrollableTitle" aria-hidden="true" style="display: none; z-index:10000;">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalScrollableTitle">Search Filter</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= form_with url: gruppettos_path, method: :get do |form| %>

          <%#= form.label :zip_code, "Zip Code" %>
          <%#= form.select :zip_code,
                    {
                      "Melbourne Zip Codes" => [3002, 8002, 3000, 3001, 3004, 8001, 3045, 3052, 5006, 3051, 3207, 3050, 3205, 3004, 3010, 3003]
                    } %>

          <%= form.label :speed, "Speed" %>
          <%= form.number_field :speed, in: 1..50%>
        <hr>
          <%= form.label :difficulty, "Difficulty" %>
          <%= form.select :difficulty,
                    {
                      "Options" => [ ["Easy"], ["Moderate"], ["Hard"] ]
                    } %>
        <hr>
          <%#= form.label :length, "Length" %>
          <%#= form.range_field :length, in: 1..200%>

          <%= form.label :start_date, "Start Date" %>
          <%= form.date_field :start_date%>
        <hr>
          <%= form.label :end_date, "End Date" %>
          <%= form.date_field :end_date%>
        <hr>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <%= form.submit "Search", class: "btn btn-primary" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<div class="my-5">
<% @gruppettos.each do | gruppetto | %>
  <%# renders the index_card.html.erb with sending the gruppetto params %>
  <div class="">
    <%= render "index_card", gruppetto: gruppetto %>
  </div>
<% end %>
</div>
</div>
<div class="d-flex justify-content-between fixed-bottom bg-white p-2">
  <div class="w-50">
    <%= link_to "Back to Grupettos", gruppettos_path, class: "btn btn-outline-primary w-100" %>
  </div>
  <div class="w-50">
    <%= link_to "Home", root_path,class: "btn btn-primary w-100"%>
  </div>
</div>
